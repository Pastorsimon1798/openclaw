#!/bin/bash
# Bitwarden secret retrieval helper
# Usage: bw-get "Secret Name"

source ~/.bw_session 2>/dev/null

if [ -z "$BW_SESSION" ]; then
    echo "Error: Bitwarden session not loaded. Run: source ~/.bw_session" >&2
    exit 1
fi

if [ -z "$1" ]; then
    echo "Usage: bw-get \"Secret Name\"" >&2
    echo "Available secrets:" >&2
    npx @bitwarden/cli list items --session "$BW_SESSION" 2>/dev/null | jq -r '.[].name'
    exit 1
fi

npx @bitwarden/cli get notes "$1" --session "$BW_SESSION" 2>/dev/null
